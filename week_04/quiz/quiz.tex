\documentclass[10pt]{article}

\usepackage[margin=1in]{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage[shortlabels]{enumitem}
\usepackage[normalem]{ulem}

\usepackage{hyperref}
\hypersetup{
  colorlinks   = true, %Colours links instead of ugly boxes
  urlcolor     = black, %Colour for external hyperlinks
  linkcolor    = blue, %Colour of internal links
  citecolor    = blue  %Colour of citations
}

\usepackage{courier}
\usepackage{listings}
\lstset{numbers=left}
\lstset{basicstyle=\ttfamily}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{definition}
\newtheorem{problem}{Problem}
\newcommand{\E}{\mathbb E}
\newcommand{\R}{\mathbb R}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

\newcommand{\trans}[1]{{#1}^{T}}
\newcommand{\loss}{\ell}
\newcommand{\w}{\mathbf w}
\newcommand{\mle}[1]{\hat{#1}_{\textit{mle}}}
\newcommand{\map}[1]{\hat{#1}_{\textit{map}}}
\newcommand{\normal}{\mathcal{N}}
\newcommand{\x}{\mathbf x}
\newcommand{\y}{\mathbf y}
\newcommand{\ltwo}[1]{\lVert {#1} \rVert}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{center}
{
\Large
    \sout{Quiz}Take-Home Exercise: Joins
}

    \vspace{0.1in}
\end{center}


\vspace{0.15in}
\noindent
\textbf{Total Score:} ~~~~~~~~~~~~~~~/6

\vspace{0.5in}
\noindent
\textbf{Printed Name:}

\noindent
\rule{\textwidth}{0.1pt}
\vspace{0.25in}

\noindent
\textbf{Rules:}
\begin{enumerate}
    \item You MAY use any printed or handwritten notes.
    \item You MAY \sout{NOT} use a computer or any other electronic device.
    \item You MAY \sout{NOT} discuss this quiz with any other human.
\end{enumerate}

\noindent
\textbf{Note:}
You are allowed to use any resources you want, but you should try to solve these by hand before typing them into postgres.

\vspace{0.25in}
\noindent
\textbf{Instructions:}
For each problem, write the output of the given SQL command.
Assume that the following tables/rows have been added to the database:
\begin{lstlisting}
CREATE TABLE basket_a (
    a INT PRIMARY KEY,
    fruit_a VARCHAR (100) NOT NULL
);

CREATE TABLE basket_b (
    b INT PRIMARY KEY,
    fruit_b VARCHAR (100) NOT NULL
);

INSERT INTO basket_a (a, fruit_a)
VALUES
    (1, 'Apple'),
    (2, 'Orange'),
    (3, 'Banana'),
    (4, 'Cucumber');

INSERT INTO basket_b (b, fruit_b)
VALUES
    (1, 'Orange'),
    (2, 'Apple'),
    (3, 'Watermelon'),
    (4, 'Pear');
\end{lstlisting}

\newpage
\textbf{Problem 1:}
\begin{lstlisting}
SELECT fruit_a FROM basket_a NATURAL JOIN basket_b;
\end{lstlisting}

\vspace{3in}
\textbf{Problem 2:}
\begin{lstlisting}
SELECT fruit_a FROM basket_a NATURAL JOIN basket_b UNION (SELECT fruit_a FROM basket_a);
\end{lstlisting}

\newpage
\textbf{Problem 3:}
\begin{lstlisting}
SELECT fruit_a,fruit_b FROM basket_a LEFT JOIN basket_b ON (b>a);
\end{lstlisting}

\vspace{3in}
\textbf{Problem 4:}
\begin{lstlisting}
SELECT fruit_a,fruit_b FROM basket_a FULL OUTER JOIN basket_b ON (fruit_b=fruit_a);
\end{lstlisting}

\newpage
\textbf{Problem 5:}
\begin{lstlisting}
SELECT fruit_a,fruit_b FROM basket_a JOIN basket_b ON (b != a);
\end{lstlisting}

\vspace{3in}
\textbf{Problem 6:}
\begin{lstlisting}
SELECT fruit_a,fruit_b FROM basket_a RIGHT OUTER JOIN basket_b ON (fruit_b<fruit_a);
\end{lstlisting}
\end{document}
